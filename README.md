# OpenCellsId_task

В данном репозитории представлены:
- код Apache Airflow DAG;
- DDL код создание таблицы Clickhouse;
- SQL запрос для реализации запроса.

Для работы с Clickhouse был развернут сервер на основе Docker образа.

### Принцип работы DAG
Airflow DAG скачивает архив с базой данных из открытого источника, производит его разархивацию и декодирование в нужный формат. Далее записывает всё в Pandas DataFrame, добавляет названия столбцов и исключает строки по некоторым значениям **mcc**. 

Потом передает DataFrame в функцию, которая осуществляет связь с базой данных ClickHouse и производит загрузку данных в конкретную, заранее созданную таблицу с движком MergeTree.
  
